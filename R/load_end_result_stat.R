.base.col.types <- c("character",
                     "character",
                     "integer",
                     "numeric",
                     "character",
                     "numeric",
                     "character",
                     "numeric",
                     "character",
                     "numeric",
                     "character",
                     "numeric",
                     "character",
                     "numeric",
                     "character",
                     "numeric",
                     "character",
                     "numeric",
                     "character",
                     "numeric",
                     "character",
                     "numeric",
                     "character",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "numeric",
                     "character",
                     "numeric",
                     "numeric",
                     "character",
                     "numeric",
                     "numeric",
                     "numeric",
                     "character",
                     "numeric",
                     "numeric",
                     "character",
                     "numeric",
                     "numeric");

.base.col.names <- c("algorithm",
                     "instance",
                     "n.runs",
                     "best.f.min",
                     "best.f.min.setup",
                     "best.f.q050",
                     "best.f.q050.setup",
                     "best.f.q159",
                     "best.f.q159.setup",
                     "best.f.q250",
                     "best.f.q250.setup",
                     "best.f.median",
                     "best.f.median.setup",
                     "best.f.q750",
                     "best.f.q750.setup",
                     "best.f.q841",
                     "best.f.q841.setup",
                     "best.f.q950",
                     "best.f.q950.setup",
                     "best.f.max",
                     "best.f.max.setup",
                     "best.f.mean",
                     "best.f.mean.setup",
                     "best.f.sd",
                     "total.time.min",
                     "total.time.q050",
                     "total.time.q159",
                     "total.time.q250",
                     "total.time.median",
                     "total.time.q750",
                     "total.time.q841",
                     "total.time.q950",
                     "total.time.max",
                     "total.time.mean",
                     "total.time.sd",
                     "total.fes.min",
                     "total.fes.q050",
                     "total.fes.q159",
                     "total.fes.q250",
                     "total.fes.median",
                     "total.fes.q750",
                     "total.fes.q841",
                     "total.fes.q950",
                     "total.fes.max",
                     "total.fes.mean",
                     "total.fes.sd",
                     "last.improvement.time.min",
                     "last.improvement.time.q050",
                     "last.improvement.time.q159",
                     "last.improvement.time.q250",
                     "last.improvement.time.median",
                     "last.improvement.time.q750",
                     "last.improvement.time.q841",
                     "last.improvement.time.q950",
                     "last.improvement.time.max",
                     "last.improvement.time.mean",
                     "last.improvement.time.sd",
                     "last.improvement.fes.min",
                     "last.improvement.fes.q050",
                     "last.improvement.fes.q159",
                     "last.improvement.fes.q250",
                     "last.improvement.fes.median",
                     "last.improvement.fes.q750",
                     "last.improvement.fes.q841",
                     "last.improvement.fes.q950",
                     "last.improvement.fes.max",
                     "last.improvement.fes.mean",
                     "last.improvement.fes.sd",
                     "n.improvements.min",
                     "n.improvements.q050",
                     "n.improvements.q159",
                     "n.improvements.q250",
                     "n.improvements.median",
                     "n.improvements.q750",
                     "n.improvements.q841",
                     "n.improvements.q950",
                     "n.improvements.max",
                     "n.improvements.mean",
                     "n.improvements.sd",
                     "budget.time.min",
                     "budget.time.median",
                     "budget.time.max",
                     "budget.time.mean",
                     "budget.time.sd",
                     "budget.FEs.min",
                     "budget.FEs.median",
                     "budget.FEs.max",
                     "budget.FEs.mean",
                     "budget.FEs.sd",
                     "n.successes",
                     "ert.time",
                     "ert.fes",
                     "success.time.min",
                     "success.time.min.setup",
                     "success.time.median",
                     "success.time.max",
                     "success.time.max.setup",
                     "success.time.mean",
                     "success.time.sd",
                     "success.fes.min",
                     "success.fes.min.setup",
                     "success.fes.median",
                     "success.fes.max",
                     "success.fes.max.setup",
                     "success.fes.mean",
                     "success.fes.sd");

#' @title Load the End Result Statistics from a File
#' @description Load the end result statistics from a file generated by the
#'   aitoa log processing.
#' @param file the file to load
#' @return the data frame with the end results
#' @export aitoa.load.end.result.stats
aitoa.load.end.result.stats <- function(file) {
  stopifnot(is.character(file),
            length(file) == 1L,
            !is.na(file),
            !is.null(file),
            nchar(file) > 0L);
  file <- normalizePath(file, mustWork = TRUE);
  stopifnot(is.character(file),
            length(file) == 1L,
            !is.na(file),
            !is.null(file),
            nchar(file) > 0L,
            file.exists(file),
            file.size(file) > 100L);

  data <- read.csv(file,
                   header=TRUE,
                   sep=";",
                   stringsAsFactors = FALSE,
                   check.names = TRUE,
                   blank.lines.skip = TRUE,
                   comment.char = '#',
                   col.names = .base.col.names,
                   colClasses = .base.col.types);

  stopifnot(is.data.frame(data),
            nrow(data) > 0L,
            all(colnames(data) == .base.col.names),
            all(data$best.f.min <= data$best.f.q050),
            all(data$best.f.q050 <= data$best.f.q159),
            all(data$best.f.q159 <= data$best.f.q250),
            all(data$best.f.q250 <= data$best.f.median),
            all(data$best.f.median <= data$best.f.q750),
            all(data$best.f.q750 <= data$best.f.q841),
            all(data$best.f.q841 <= data$best.f.q950),
            all(data$best.f.q950 <= data$best.f.max));

  return(data);
}
